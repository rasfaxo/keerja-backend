# ============================================================
# Keerja Backend - STAGING Environment Configuration
# ============================================================
#
# PURPOSE:
#   Environment variables for STAGING deployment on VPS
#   Used by: docker-compose.vps.yml (api-staging service)
#   URL: http://staging-api.145.79.8.227.nip.io
#
# USAGE:
#   1. Copy this file: cp .env.staging.example .env.staging
#   2. Update values with actual credentials
#   3. NEVER commit .env.staging to git
#
# INTEGRATION:
#   - Preserves all variables from existing .env.example
#   - Adds VPS-specific configurations
#   - Compatible with existing codebase (internal/config/env.go)
# ============================================================

# ==========================================
# Application Configuration
# ==========================================
APP_NAME=Keerja Backend
APP_ENV=staging
APP_PORT=8080
APP_VERSION=staging

# Server Configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# ==========================================
# Database Configuration (STAGING)
# PostgreSQL connection for keerja_staging database
# ==========================================
# Note: DB_HOST is overridden in docker-compose.vps.yml to use container name
DB_HOST=postgres
DB_PORT=5432
DB_USER=bekerja
DB_PASSWORD=CHANGE_THIS_STAGING_DB_PASSWORD
DB_NAME=keerja_staging
DB_SSLMODE=disable

# Full DATABASE_URL (constructed from above, but can override)
DATABASE_URL=postgresql://bekerja:CHANGE_THIS_STAGING_DB_PASSWORD@postgres:5432/keerja_staging?sslmode=disable

# PostgreSQL Admin (for container initialization)
POSTGRES_PASSWORD=CHANGE_THIS_POSTGRES_ADMIN_PASSWORD

# Migrator role (used by cmd/migrate)
DB_MIGRATOR_USER=kustan
DB_MIGRATOR_PASSWORD=CHANGE_THIS_MIGRATOR_PASSWORD

# App role (used by main application)
DB_APP_USER=bekerja
DB_APP_PASSWORD=CHANGE_THIS_STAGING_DB_PASSWORD

# Staging-specific DB credentials (used by docker-compose.vps.yml)
STAGING_DB_USER=bekerja
STAGING_DB_PASSWORD=CHANGE_THIS_STAGING_DB_PASSWORD

# ==========================================
# Redis Configuration
# Shared Redis with STAGING using DB 0
# ==========================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_THIS_REDIS_PASSWORD
REDIS_DB=0
REDIS_URL=redis://:CHANGE_THIS_REDIS_PASSWORD@redis:6379/0

# ==========================================
# JWT Configuration
# Use different secrets per environment for security
# ==========================================
JWT_SECRET=CHANGE_THIS_STAGING_JWT_SECRET_MINIMUM_32_CHARS_LONG_RANDOM_STRING
JWT_EXPIRE_HOURS=24
JWT_REFRESH_EXPIRE_DAYS=7

# ==========================================
# CORS Configuration (Critical for Web + Mobile)
# ==========================================
# Comma-separated list of allowed origins
# Include: local dev, staging frontend, mobile apps
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:5173,http://staging-api.145.79.8.227.nip.io,http://staging.keerja.com

# ==========================================
# Frontend URLs (STAGING)
# Update these to match your staging frontend deployment
# ==========================================
FRONTEND_URL=http://staging.keerja.com
VERIFY_EMAIL_URL=http://staging.keerja.com/verify-email
RESET_PASSWORD_URL=http://staging.keerja.com/reset-password
DASHBOARD_URL=http://staging.keerja.com/dashboard

# ==========================================
# Mail Configuration (Production SMTP)
# Use real SMTP for staging to test email flows
# ==========================================
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password
MAIL_FROM=noreply@keerja.com
MAIL_FROM_NAME=Keerja Staging

# Alternative: Use MailHog for testing (if deployed on VPS)
# MAIL_HOST=mailhog
# MAIL_PORT=1025
# MAIL_FROM=noreply@keerja.local

# ==========================================
# Google OAuth Configuration
# Use staging OAuth credentials
# ==========================================
GOOGLE_CLIENT_ID=your-staging-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-staging-client-secret
GOOGLE_REDIRECT_URI=http://staging-api.145.79.8.227.nip.io/api/v1/auth/oauth/google/callback
GOOGLE_CREDENTIALS_FILE=

# Mobile OAuth redirect URIs (comma-separated)
ALLOWED_MOBILE_REDIRECT_URIS=keerja://oauth-callback,com.keerja.app://oauth-callback

# ==========================================
# Storage Configuration (MinIO/S3)
# ==========================================
# Option 1: Local MinIO on VPS
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=CHANGE_THIS_MINIO_SECRET
MINIO_USE_SSL=false
MINIO_BUCKET=keerja-staging

# MinIO Root Credentials (if running MinIO container)
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=CHANGE_THIS_MINIO_SECRET

# Option 2: AWS S3 (recommended for production)
# AWS_REGION=ap-southeast-1
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# S3_BUCKET=keerja-staging-uploads

# File upload limits
MAX_UPLOAD_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf

# ==========================================
# Firebase Cloud Messaging (FCM)
# Push notifications for mobile app
# ==========================================
FCM_ENABLED=true
FCM_PROJECT_ID=your-firebase-project-id
FCM_CREDENTIALS_FILE=./config/firebase-service-account.json
FCM_TIMEOUT=30s
FCM_BATCH_SIZE=500
FCM_MAX_RETRIES=3
PUSH_DEFAULT_SOUND=default
PUSH_DEFAULT_TTL=86400

# ==========================================
# Logging Configuration
# ==========================================
LOG_LEVEL=debug
LOG_FORMAT=json

# ==========================================
# Timezone
# ==========================================
TZ=Asia/Jakarta

# ==========================================
# Support Configuration
# ==========================================
SUPPORT_EMAIL=support@keerja.com

# ==========================================
# API Documentation (Bump.sh)
# ==========================================
API_DOCS_URL=https://bump.sh/doc/keerja-api-staging
API_BASE_URL=http://staging-api.145.79.8.227.nip.io

# ==========================================
# Rate Limiting
# ==========================================
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_DURATION=1m

# ==========================================
# Health Check
# ==========================================
HEALTH_CHECK_PATH=/health/live
READY_CHECK_PATH=/health/ready
