swagger: "2.0"
info:
  description: "API Documentation for Keerja Backend. This documentation covers all available endpoints for the Keerja platform, including authentication, user management, job postings, applications, company management, and admin features."
  version: "1.0.0"
  title: "Keerja Backend API"
  contact:
    email: "dev@keerja.com"
host: "localhost:8080"
basePath: "/api/v1"
tags:
  - name: "Auth"
    description: "Authentication and Authorization"
  - name: "User"
    description: "User Profile and Management"
  - name: "Job"
    description: "Job Posting and Search"
  - name: "Application"
    description: "Job Applications Management"
  - name: "Company"
    description: "Company Profile and Management"
  - name: "Master"
    description: "Master Data (Locations, Industries, Skills)"
  - name: "Admin"
    description: "Admin Dashboard and Moderation"
  - name: "Notification"
    description: "Push Notifications and Device Tokens"
  - name: "Chat"
    description: "Messaging and Conversations"

schemes:
  - "http"
  - "https"

securityDefinitions:
  Bearer:
    type: "apiKey"
    name: "Authorization"
    in: "header"
    description: "Enter your Bearer token in the format **Bearer &lt;token&gt;**"

paths:
  # ==========================================================
  # AUTH ENDPOINTS
  # ==========================================================
  /auth/register:
    post:
      tags: ["Auth"]
      summary: "Register a new user"
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/RegisterRequest"
      responses:
        201:
          description: "User registered successfully"
        400:
          description: "Invalid input"

  /auth/login:
    post:
      tags: ["Auth"]
      summary: "Login"
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/LoginRequest"
      responses:
        200:
          description: "Login successful"
          schema:
            $ref: "#/definitions/AuthResponse"
        401:
          description: "Invalid credentials"

  /auth/verify-email:
    post:
      tags: ["Auth"]
      summary: "Verify Email"
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/VerifyEmailRequest"
      responses:
        200:
          description: "Email verified"

  /auth/forgot-password:
    post:
      tags: ["Auth"]
      summary: "Forgot Password"
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/ForgotPasswordRequest"
      responses:
        200:
          description: "Reset email sent"

  /auth/reset-password:
    post:
      tags: ["Auth"]
      summary: "Reset Password"
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/ResetPasswordRequest"
      responses:
        200:
          description: "Password reset successfully"

  /auth/refresh-token:
    post:
      tags: ["Auth"]
      summary: "Refresh Access Token"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/RefreshTokenRequest"
      responses:
        200:
          description: "Token refreshed"
          schema:
            $ref: "#/definitions/AuthResponse"

  /auth/logout:
    post:
      tags: ["Auth"]
      summary: "Logout"
      security:
        - Bearer: []
      responses:
        200:
          description: "Logged out successfully"

  # ==========================================================
  # USER ENDPOINTS
  # ==========================================================
  /users/me:
    get:
      tags: ["User"]
      summary: "Get My Profile"
      security:
        - Bearer: []
      responses:
        200:
          description: "User profile data"
          schema:
            $ref: "#/definitions/UserProfile"
    put:
      tags: ["User"]
      summary: "Update My Profile"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/UpdateProfileRequest"
      responses:
        200:
          description: "Profile updated"

  /users/me/preferences:
    get:
      tags: ["User"]
      summary: "Get User Preferences"
      security:
        - Bearer: []
      responses:
        200:
          description: "User preferences"
    put:
      tags: ["User"]
      summary: "Update User Preferences"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/UpdateUserPreferencesRequest"
      responses:
        200:
          description: "Preferences updated"

  /users/me/education:
    post:
      tags: ["User"]
      summary: "Add Education"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/AddEducationRequest"
      responses:
        201:
          description: "Education added"

  /users/me/experience:
    post:
      tags: ["User"]
      summary: "Add Experience"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/AddExperienceRequest"
      responses:
        201:
          description: "Experience added"

  /users/me/skills/batch:
    post:
      tags: ["User"]
      summary: "Add Skills (Batch)"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/AddUserSkillsRequest"
      responses:
        201:
          description: "Skills added"

  # ==========================================================
  # JOB ENDPOINTS
  # ==========================================================
  /jobs:
    get:
      tags: ["Job"]
      summary: "List Jobs"
      parameters:
        - in: "query"
          name: "q"
          type: "string"
        - in: "query"
          name: "location"
          type: "string"
        - in: "query"
          name: "job_type_ids"
          type: "array"
          items:
            type: "integer"
        - in: "query"
          name: "page"
          type: "integer"
        - in: "query"
          name: "limit"
          type: "integer"
      responses:
        200:
          description: "List of jobs"
    post:
      tags: ["Job"]
      summary: "Create Job"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/CreateJobRequest"
      responses:
        201:
          description: "Job created"

  /jobs/{id}:
    get:
      tags: ["Job"]
      summary: "Get Job Details"
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
      responses:
        200:
          description: "Job details"
    put:
      tags: ["Job"]
      summary: "Update Job"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/UpdateJobRequest"
      responses:
        200:
          description: "Job updated"
    delete:
      tags: ["Job"]
      summary: "Delete Job"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
      responses:
        200:
          description: "Job deleted"

  /jobs/draft:
    post:
      tags: ["Job"]
      summary: "Save Job Draft"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/SaveJobDraftRequest"
      responses:
        200:
          description: "Draft saved"

  /jobs/my-jobs:
    get:
      tags: ["Job"]
      summary: "Get My Jobs (Employer)"
      security:
        - Bearer: []
      responses:
        200:
          description: "List of employer's jobs"

  # ==========================================================
  # APPLICATION ENDPOINTS
  # ==========================================================
  /applications:
    post:
      tags: ["Application"]
      summary: "Submit Application"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/ApplyJobRequest"
      responses:
        201:
          description: "Application submitted"

  /applications/my-applications:
    get:
      tags: ["Application"]
      summary: "My Applications"
      security:
        - Bearer: []
      responses:
        200:
          description: "List of applications"

  /applications/{id}/status:
    patch:
      tags: ["Application"]
      summary: "Update Application Status"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/UpdateApplicationStatusRequest"
      responses:
        200:
          description: "Status updated"

  /applications/{id}/interviews:
    post:
      tags: ["Application"]
      summary: "Schedule Interview"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/ScheduleInterviewRequest"
      responses:
        201:
          description: "Interview scheduled"

  # ==========================================================
  # COMPANY ENDPOINTS
  # ==========================================================
  /companies:
    get:
      tags: ["Company"]
      summary: "List Companies"
      parameters:
        - in: "query"
          name: "q"
          type: "string"
        - in: "query"
          name: "industry"
          type: "string"
      responses:
        200:
          description: "List of companies"
    post:
      tags: ["Company"]
      summary: "Register Company"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/RegisterCompanyRequest"
      responses:
        201:
          description: "Company registered"

  /companies/{id}:
    get:
      tags: ["Company"]
      summary: "Get Company Details"
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
      responses:
        200:
          description: "Company details"
    put:
      tags: ["Company"]
      summary: "Update Company"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/UpdateCompanyRequest"
      responses:
        200:
          description: "Company updated"

  /companies/{id}/review:
    post:
      tags: ["Company"]
      summary: "Add Company Review"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/AddReviewRequest"
      responses:
        201:
          description: "Review added"

  /companies/{id}/invite-employee:
    post:
      tags: ["Company"]
      summary: "Invite Employee"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "integer"
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/InviteEmployeeRequest"
      responses:
        201:
          description: "Invitation sent"

  # ==========================================================
  # CHAT ENDPOINTS
  # ==========================================================
  /chat/conversations:
    get:
      tags: ["Chat"]
      summary: "Get Conversations"
      security:
        - Bearer: []
      responses:
        200:
          description: "List of conversations"
    post:
      tags: ["Chat"]
      summary: "Start Conversation"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/CreateConversationRequest"
      responses:
        201:
          description: "Conversation created"

  /chat/conversations/{id}/messages:
    get:
      tags: ["Chat"]
      summary: "Get Messages"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "string"
      responses:
        200:
          description: "List of messages"
    post:
      tags: ["Chat"]
      summary: "Send Message"
      security:
        - Bearer: []
      parameters:
        - in: "path"
          name: "id"
          required: true
          type: "string"
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/SendMessageRequest"
      responses:
        201:
          description: "Message sent"

  # ==========================================================
  # NOTIFICATION ENDPOINTS
  # ==========================================================
  /device-tokens:
    post:
      tags: ["Notification"]
      summary: "Register Device Token"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/RegisterDeviceTokenRequest"
      responses:
        201:
          description: "Token registered"

  /push/send/device:
    post:
      tags: ["Notification"]
      summary: "Send Push to Device"
      security:
        - Bearer: []
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/SendPushToDeviceRequest"
      responses:
        200:
          description: "Notification sent"

  # ==========================================================
  # MASTER DATA ENDPOINTS
  # ==========================================================
  /master/industries:
    get:
      tags: ["Master"]
      summary: "Get Industries"
      responses:
        200:
          description: "List of industries"

  /master/company-sizes:
    get:
      tags: ["Master"]
      summary: "Get Company Sizes"
      responses:
        200:
          description: "List of company sizes"

  /master/locations/provinces:
    get:
      tags: ["Master"]
      summary: "Get Provinces"
      responses:
        200:
          description: "List of provinces"

  /master/locations/cities:
    get:
      tags: ["Master"]
      summary: "Get Cities"
      parameters:
        - in: "query"
          name: "province_id"
          type: "integer"
      responses:
        200:
          description: "List of cities"

  /master/job-titles:
    get:
      tags: ["Master"]
      summary: "Get Job Titles"
      responses:
        200:
          description: "List of job titles"

definitions:
  # Auth
  RegisterRequest:
    type: object
    required:
      - full_name
      - email
      - password
      - user_type
    properties:
      full_name:
        type: string
        minLength: 3
        maxLength: 150
      email:
        type: string
        maxLength: 150
      phone:
        type: string
        minLength: 10
        maxLength: 20
      password:
        type: string
        minLength: 8
        maxLength: 72
      user_type:
        type: string
        enum: ["jobseeker", "employer"]

  LoginRequest:
    type: object
    required:
      - email
      - password
    properties:
      email:
        type: string
      password:
        type: string

  VerifyEmailRequest:
    type: object
    required:
      - token
    properties:
      token:
        type: string

  ForgotPasswordRequest:
    type: object
    required:
      - email
    properties:
      email:
        type: string

  ResetPasswordRequest:
    type: object
    required:
      - token
      - new_password
    properties:
      token:
        type: string
      new_password:
        type: string
        minLength: 8
        maxLength: 72

  RefreshTokenRequest:
    type: object
    required:
      - refresh_token
    properties:
      refresh_token:
        type: string

  AuthResponse:
    type: object
    properties:
      access_token:
        type: string
      refresh_token:
        type: string
      expires_in:
        type: integer

  # User
  UserProfile:
    type: object
    properties:
      id:
        type: integer
      email:
        type: string
      full_name:
        type: string
      avatar_url:
        type: string

  UpdateProfileRequest:
    type: object
    properties:
      full_name:
        type: string
        minLength: 3
        maxLength: 150
      phone:
        type: string
        minLength: 10
        maxLength: 20
      headline:
        type: string
        maxLength: 150
      bio:
        type: string
      gender:
        type: string
        enum: ["male", "female", "other"]
      linkedin_url:
        type: string
      portfolio_url:
        type: string

  UpdateUserPreferencesRequest:
    type: object
    properties:
      language_preference:
        type: string
      theme_preference:
        type: string
        enum: ["light", "dark"]
      email_notifications:
        type: boolean
      push_notifications:
        type: boolean

  AddEducationRequest:
    type: object
    required:
      - institution_name
    properties:
      institution_name:
        type: string
        maxLength: 200
      major:
        type: string
        maxLength: 150
      degree_level:
        type: string
        maxLength: 100
      start_year:
        type: integer
        minimum: 1900
      end_year:
        type: integer
        minimum: 1900
      gpa:
        type: number
        minimum: 0
        maximum: 4
      is_current:
        type: boolean

  AddExperienceRequest:
    type: object
    required:
      - company_name
      - position_title
      - start_date
    properties:
      company_name:
        type: string
        maxLength: 200
      position_title:
        type: string
        maxLength: 150
      employment_type:
        type: string
        enum: ["full-time", "part-time", "contract", "internship", "freelance"]
      start_date:
        type: string
      end_date:
        type: string
      is_current:
        type: boolean
      description:
        type: string

  AddUserSkillsRequest:
    type: object
    required:
      - skills
    properties:
      skills:
        type: array
        items:
          $ref: "#/definitions/AddUserSkillRequest"

  AddUserSkillRequest:
    type: object
    properties:
      skill_id:
        type: integer
      skill_name:
        type: string
      proficiency_level:
        type: string
        enum: ["beginner", "intermediate", "advanced", "expert"]
      years_of_experience:
        type: integer

  # Job
  CreateJobRequest:
    type: object
    required:
      - company_id
      - description
      - job_type_id
      - work_policy_id
      - salary_min
      - salary_max
      - skills
    properties:
      company_id:
        type: integer
        minimum: 1
      description:
        type: string
        minLength: 50
      job_category_id:
        type: integer
      job_title_id:
        type: integer
      job_type_id:
        type: integer
      work_policy_id:
        type: integer
      education_level_id:
        type: integer
      experience_level_id:
        type: integer
      gender_preference_id:
        type: integer
      salary_min:
        type: number
        minimum: 0
      salary_max:
        type: number
        minimum: 0
      skills:
        type: array
        items:
          $ref: "#/definitions/AddSkillRequest"

  AddSkillRequest:
    type: object
    required:
      - skill_id
    properties:
      skill_id:
        type: integer
      importance_level:
        type: string
        enum: ["required", "preferred", "optional"]

  UpdateJobRequest:
    type: object
    properties:
      description:
        type: string
        minLength: 50
      salary_min:
        type: number
      salary_max:
        type: number
      min_age:
        type: integer
      max_age:
        type: integer

  SaveJobDraftRequest:
    type: object
    required:
      - company_id
      - description
    properties:
      company_id:
        type: integer
      description:
        type: string
      job_title_id:
        type: integer
      salary_min:
        type: number
      salary_max:
        type: number

  # Application
  ApplyJobRequest:
    type: object
    required:
      - job_id
    properties:
      job_id:
        type: integer
      resume_url:
        type: string
      cover_letter:
        type: string
        maxLength: 2000
      source:
        type: string

  UpdateApplicationStatusRequest:
    type: object
    required:
      - status
    properties:
      status:
        type: string
        enum: ["pending", "screening", "shortlisted", "interview", "offered", "rejected", "withdrawn"]
      notes:
        type: string
      rejection_reason:
        type: string

  ScheduleInterviewRequest:
    type: object
    required:
      - application_id
      - scheduled_at
    properties:
      application_id:
        type: integer
      scheduled_at:
        type: string
        format: date-time
      interview_type:
        type: string
        enum: ["online", "onsite", "hybrid"]
      meeting_link:
        type: string
      location:
        type: string
      notes:
        type: string

  # Company
  RegisterCompanyRequest:
    type: object
    required:
      - company_name
    properties:
      company_name:
        type: string
        minLength: 2
        maxLength: 200
      legal_name:
        type: string
        maxLength: 200
      industry_id:
        type: integer
      description:
        type: string
      website_url:
        type: string

  UpdateCompanyRequest:
    type: object
    required:
      - short_description
      - company_description
    properties:
      short_description:
        type: string
        maxLength: 1000
      company_description:
        type: string
      website_url:
        type: string
      instagram_url:
        type: string
      linkedin_url:
        type: string

  AddReviewRequest:
    type: object
    required:
      - rating_overall
    properties:
      rating_overall:
        type: number
        minimum: 1
        maximum: 5
      pros:
        type: string
      cons:
        type: string
      is_anonymous:
        type: boolean

  InviteEmployeeRequest:
    type: object
    required:
      - email
      - full_name
      - position
      - role
    properties:
      email:
        type: string
      full_name:
        type: string
      position:
        type: string
      role:
        type: string
        enum: ["admin", "hr", "recruiter", "manager", "viewer"]

  # Chat
  CreateConversationRequest:
    type: object
    required:
      - recipient_id
    properties:
      recipient_id:
        type: integer

  SendMessageRequest:
    type: object
    required:
      - content
    properties:
      content:
        type: string
        maxLength: 5000

  # Notification
  RegisterDeviceTokenRequest:
    type: object
    required:
      - token
      - platform
    properties:
      token:
        type: string
        minLength: 10
        maxLength: 4096
      platform:
        type: string
        enum: ["android", "ios", "web"]
      device_info:
        type: string

  SendPushToDeviceRequest:
    type: object
    required:
      - token
      - title
      - body
    properties:
      token:
        type: string
      title:
        type: string
      body:
        type: string
      data:
        type: string
